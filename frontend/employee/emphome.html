<html>
 <head>
  <title>
   Billing
  </title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="emphome.css">
  <script src="emphome.js"></script>
 </head>
 <body>
  <div class="header">
   <img alt="Company Logo" height="50" src="https://storage.googleapis.com/a1aa/image/2oY1VVNf7SwbYi04u2yXuwi1O88TILH4UQQir6M21zH9LQ6JA.jpg" width="50"/>
   <h1>
    Billing
   </h1>
   <div class="right">
    <a href="#" onclick="openChangePasswordPopup()">
     <i class="fas fa-key">
     </i>
     Change Password
    </a>
    <a href="#" onclick="openLogoutPopup()">
     <i class="fas fa-sign-out-alt">
     </i>
     Logout
    </a>
    <a href="#" onclick="openViewAddItemsPopup()">
     <i class="fas fa-eye">
     </i>
     view add items
    </a>
    <span>
     Welcome, employee
    </span>
   </div>
  </div>
  <form id="" >
  <div class="container">
   <div class="section">
    <label for="billNo">
     Bill No:
    </label>
    <input disabled="" id="billNo" type="text"/>
   </div>
   <div class="section">
    <h2>
     Customer Details
    </h2>
    <label for="contactNo">
     Contact No:
    </label>
    <input id="contactNo" type="text"/>
    <label for="name">
     Name:
    </label>
    <input id="name" type="text"/>
    <label for="email">
     Email:
    </label>
    <input id="email" type="text"/>
    <label for="address">
     Address:
    </label>
    <input id="address" type="text"/>
   </div>
   </form>
   <div class="section">
    <h2>
     Product Details
    </h2>
    <label for="productId">
     Product ID:
    </label>
    <select id="Product_id">
        <option value=""></option>
      </select>
    <input disabled="" id="productId" type="text"/>
    <label for="productName">
     Product Name:
    </label>
    <input id="productName" type="text"/>
    <label for="price">
     Price:
    </label>
    <input id="price" type="text"/>
    <label for="quantity">
     Quantity:
    </label>
    <input id="quantity" type="text"/>
    <label for="description">
     Description:
    </label>
    <input id="description" type="text"/>
    <button>
     <i class="fas fa-cart-plus">
     </i>
     Add To Cart
    </button>
   </div>
   <div class="table-container">
    <table>
     <thead>
      <tr>
       <th>
        SN
       </th>
       <th>
        Particular
       </th>
       <th>
        Qty
       </th>
       <th>
        Price
       </th>
       <th>
        Amount
       </th>
      </tr>
     </thead>
     <tbody>
      <!-- Table rows will be dynamically added here -->
     </tbody>
    </table>
   </div>
   <div class="section">
    <label for="paymentOptions">
     Payment Options:
    </label>
    <select id="paymentOptions">
     <option value="cash">
      Cash
     </option>
    </select>
   </div>
   <div class="total-section">
    <div>
     <label for="totalBill">
      Your Total Bill:
     </label>
     <input disabled="" id="totalBill" type="text"/>
    </div>
    <div>
     <label for="cashProvided">
      Cash Provided:
     </label>
     <input id="cashProvided" type="text"/>
    </div>
    <div>
     <label for="returnAmount">
      Return Amount:
     </label>
     <input disabled="" id="returnAmount" type="text"/>
    </div>
   </div>
   <div class="button-container">
    <button>
     Save &amp; Print
    </button>
   </div>
   <div class="total-section">
    <div>
     <label for="subtotal">
      Subtotal:
     </label>
     <input disabled="" id="subtotal" type="text"/>
    </div>
    <div>
     <label for="discount">
      Discount(%):
     </label>
     <input id="discount" type="text"/>
    </div>
    <div>
     <label for="taxableAmount">
      Taxable Amount:
     </label>
     <input disabled="" id="taxableAmount" type="text"/>
    </div>
    <div>
     <label for="vat">
      Vat(%):
     </label>
     <input id="vat" type="text"/>
    </div>
    <div>
     <label for="total">
      Total:
     </label>
     <input disabled="" id="total" type="text"/>
    </div>
   </div>
  </div>
  <div class="popup" id="changePasswordPopup">
   <div class="popup-content">
    <h2>
     Change Password
    </h2>
    <input id="currentPassword" placeholder="Current Password" type="password"/>
    <input id="newPassword" placeholder="New Password" type="password"/>
    <input id="confirmPassword" placeholder="Confirm Password" type="password"/>
    <button onclick="changePassword()">
     Submit
    </button>
    <button class="close" onclick="closeChangePasswordPopup()">
     Close
    </button>
   </div>
  </div>
  <div class="popup" id="logoutPopup">
   <div class="popup-content">
    <h2>
     Confirm Logout
    </h2>
    <p>
     Are you sure you want to logout?
    </p>
    <button onclick="confirmLogout()">
     Yes
    </button>
    <button class="close" onclick="closeLogoutPopup()">
     No
    </button>
   </div>
  </div>
  <div class="popup" id="viewAddItemsPopup">
   <div class="popup-content">
    <h2>
     View Items
    </h2>
    <button class="close" onclick="closeViewAddItemsPopup()">
     Close
    </button>
    <div class="table-container">
     <table id="itemsTable">
      <thead>
       <tr>
        <th>
         Item ID
        </th>
        <th>
         Item Number
        </th>
        <th>
         Unit
        </th>
        <th>
         Buying Price
        </th>
        <th>
         Selling Price
        </th>
        <th>
         Quantity
        </th>
        <th>
         Expire Date
        </th>
        <th>
         Description
        </th>
       </tr>
      </thead>
      <tbody>
       <!-- Items will be dynamically added here -->
      </tbody>
     </table>
    </div>
   </div>
  </div>
 </body>
 <script>
//  document.getElementById('').addEventListener('submit', async (e) => {
//     e.preventDefault(); // Prevent the default form submission
//     let expiryDateValue = document.getElementById('expiry_date').value.trim();

// if (expiryDateValue === '') {
// expiryDateValue = null; // Set to null if empty
//   }

//     let formData = {
//         Category: document.getElementById('Category_id').value,
//         item_id: document.getElementById('item_id').value,
//         item_name: document.getElementById('item_name').value,
//         unit: document.getElementById('unit').value,
//         buying_price: parseFloat(document.getElementById('buying_price').value),
//         selling_price: parseFloat(document.getElementById('selling_price').value),
//         quantity: parseInt(document.getElementById('quantity').value),
//         expiry_date: expiryDateValue,
//         description: document.getElementById('description').value,
//     };

//     console.log('Submitting form with data:', formData);
//     const Url='http://localhost:3000/item';

//     try {
        
//         const response = await fetch( Url, {
//             method: 'POST',
//             headers: {
//                 'Content-Type': 'application/json',
//             },
//             body: JSON.stringify(formData),
//         })
//      .then(response => response.json())
//      .then(data => console.log(data))
//      .catch(error => console.error('Error:', error));

//         if (response.ok) {
//             alert('Item added successfully!');
//             document.getElementById('item_tb').reset(); // Reset form fields
//         } else {
//             const errorDetails = await response.text();
//             alert(`Failed to add item: ${errorDetails}`);
//         }
//     } catch (error) {
//         //console.error('Error during submission:', error);
//         //alert('An unexpected error occurred.');
//     }
// });

// document.getElementById('cancel-item').addEventListener('click', () => {
// // Clear all form inputs
// document.getElementById('item_tb').reset();

// // Optionally, reset any dynamically set fields, e.g., category dropdown
// document.getElementById('Category_id').value = '';
// document.getElementById('unit').value = 'pcs'; // Reset to default value
// });

async function getData() {
  const url = "http://localhost:3000/item";

  try {
    const response = await fetch(url, {
      headers: {
        "Content-Type": "application/json",
      },
    });

    if (!response.ok) {
      throw new Error(`Response status: ${response.status}`);
    }

    const json = await response.json();
    // Initialize the options with a default "Select itemId" option
    let products = "<option value=''>Select itemId</option>";

    // Loop through the items and create option elements
    json.forEach((item) => {
      products += `<option value='${item.item_id}'>${item.item_id}</option>`;
    });

    // Populate the dropdown with the generated options
    document.getElementById("Product_id").innerHTML = products;
  } catch (error) {
    console.error(error.message);
  }
}

document.addEventListener("DOMContentLoaded", () => {
  getData();
});

</script>
</html>